<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IoT Gateway: ota.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IoT Gateway
   &#160;<span id="projectnumber">V 1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_0039eba0f953f8e8458f7827496ca008.html">AIO</a></li><li class="navelem"><a class="el" href="dir_d7fd00bb1568bc008b0bd60104ba1257.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ota.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Over the Air update.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;esp_event.h&quot;</code><br />
<code>#include &quot;nvs_flash.h&quot;</code><br />
<code>#include &quot;esp_http_client.h&quot;</code><br />
<code>#include &quot;esp_https_ota.h&quot;</code><br />
<code>#include &quot;esp_ota_ops.h&quot;</code><br />
<code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;freertos/task.h&quot;</code><br />
<code>#include &quot;freertos/semphr.h&quot;</code><br />
<code>#include &quot;esp_log.h&quot;</code><br />
<code>#include &quot;driver/gpio.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_a_i_o___mqtt_8h_source.html">AIO_Mqtt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="led_8h_source.html">led.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_a_i_o___conf_8h_source.html">AIO_Conf.h</a>&quot;</code><br />
</div>
<p><a href="ota_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5d49cfb7dec5700ace868b0d4392a007"><td class="memItemLeft" align="right" valign="top"><a id="a5d49cfb7dec5700ace868b0d4392a007"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ota_8h.html#a5d49cfb7dec5700ace868b0d4392a007">run_ota</a> (void *params)</td></tr>
<tr class="memdesc:a5d49cfb7dec5700ace868b0d4392a007"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the Ota script and wait for the semaphore This function runs as a Task and is started during the intialisation. The update process will start if the semaphore is aviable. <br /></td></tr>
<tr class="separator:a5d49cfb7dec5700ace868b0d4392a007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2908df26405d2065a604405df6084668"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ota_8h.html#a2908df26405d2065a604405df6084668">ota</a> (<a class="el" href="structdatalink__t.html">datalink_t</a> *input)</td></tr>
<tr class="memdesc:a2908df26405d2065a604405df6084668"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation of the ota process.  <a href="ota_8h.html#a2908df26405d2065a604405df6084668">More...</a><br /></td></tr>
<tr class="separator:a2908df26405d2065a604405df6084668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184ad891b90fb3a2211b700dad13e6a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ota_8h.html#a184ad891b90fb3a2211b700dad13e6a6">on_button_pushed</a> (void *params)</td></tr>
<tr class="memdesc:a184ad891b90fb3a2211b700dad13e6a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts the ota proces Deprecated the semaphore can be given in every function.  <a href="ota_8h.html#a184ad891b90fb3a2211b700dad13e6a6">More...</a><br /></td></tr>
<tr class="separator:a184ad891b90fb3a2211b700dad13e6a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa8e1993a3665a495db127c0fbf620747"><td class="memItemLeft" align="right" valign="top">xSemaphoreHandle&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ota_8h.html#aa8e1993a3665a495db127c0fbf620747">ota_semaphore</a></td></tr>
<tr class="memdesc:aa8e1993a3665a495db127c0fbf620747"><td class="mdescLeft">&#160;</td><td class="mdescRight">Semaphore vor ota handling.  <a href="ota_8h.html#aa8e1993a3665a495db127c0fbf620747">More...</a><br /></td></tr>
<tr class="separator:aa8e1993a3665a495db127c0fbf620747"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Over the Air update. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a184ad891b90fb3a2211b700dad13e6a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a184ad891b90fb3a2211b700dad13e6a6">&#9670;&nbsp;</a></span>on_button_pushed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void on_button_pushed </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts the ota proces Deprecated the semaphore can be given in every function. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>remove this function </dd></dl>

</div>
</div>
<a id="a2908df26405d2065a604405df6084668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2908df26405d2065a604405df6084668">&#9670;&nbsp;</a></span>ota()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ota </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdatalink__t.html">datalink_t</a> *&#160;</td>
          <td class="paramname"><em>input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialisation of the ota process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input</td><td>The datalink structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa8e1993a3665a495db127c0fbf620747"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8e1993a3665a495db127c0fbf620747">&#9670;&nbsp;</a></span>ota_semaphore</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">xSemaphoreHandle ota_semaphore</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Semaphore vor ota handling. </p>
<p>If this semaphore is given. The ota script will start the update. This has the advantage, that the semaphore can be given from different parts of the code, like button press or via MQTT. But the ota function can only take the semaphore one time. Therefore, a second ota process can not be started if one is running. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
